"use strict";(globalThis.webpackChunkcoo_llm_docs=globalThis.webpackChunkcoo_llm_docs||[]).push([[3471],{8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},9527:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Reference/Storage/SQL","title":"SQL Database Storage","description":"Full-featured SQL database storage with ACID transactions and advanced querying.","source":"@site/content/Reference/Storage/SQL.md","sourceDirName":"Reference/Storage","slug":"/Reference/Storage/SQL","permalink":"/docs/docs/Reference/Storage/SQL","draft":false,"unlisted":false,"editUrl":"https://github.com/coo-llm/coo-llm-main/tree/main/docs/content/content/Reference/Storage/SQL.md","tags":[{"inline":true,"label":"reference","permalink":"/docs/docs/tags/reference"},{"inline":true,"label":"storage","permalink":"/docs/docs/tags/storage"},{"inline":true,"label":"sql","permalink":"/docs/docs/tags/sql"},{"inline":true,"label":"postgresql","permalink":"/docs/docs/tags/postgresql"}],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"tags":["reference","storage","sql","postgresql"]},"sidebar":"tutorialSidebar","previous":{"title":"File-based Storage","permalink":"/docs/docs/Reference/Storage/File"},"next":{"title":"Logging","permalink":"/docs/docs/Reference/Logging"}}');var s=t(4848),i=t(8453);const a={sidebar_position:8,tags:["reference","storage","sql","postgresql"]},o="SQL Database Storage",l={},c=[{value:"Configuration",id:"configuration",level:2},{value:"Features",id:"features",level:2},{value:"Data Structure",id:"data-structure",level:2},{value:"Implementation Details",id:"implementation-details",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"sql-database-storage",children:"SQL Database Storage"})}),"\n",(0,s.jsx)(n.p,{children:"Full-featured SQL database storage with ACID transactions and advanced querying."}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'storage:\n  runtime:\n    type: "sql"\n    addr: "postgresql://user:password@localhost/dbname?sslmode=disable"\n    max_open_conns: 25    # Optional, default 25\n    max_idle_conns: 5     # Optional, default 5\n    conn_max_lifetime: "1h" # Optional\n'})}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ACID Transactions"}),": Atomic, Consistent, Isolated, Durable operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SQL Queries"}),": Full SQL power for complex analytics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Indexing"}),": Automatic and custom database indexes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Joins & Aggregations"}),": Advanced data relationships and analytics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backup/Restore"}),": Standard database backup procedures"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"High Availability"}),": Replication and failover support"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scalability"}),": Vertical and horizontal scaling options"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"data-structure",children:"Data Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- Usage metrics table\nCREATE TABLE usage_metrics (\n    provider VARCHAR(50) NOT NULL,\n    key_id VARCHAR(100) NOT NULL,\n    metric VARCHAR(50) NOT NULL,\n    value DOUBLE PRECISION NOT NULL DEFAULT 0,\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    PRIMARY KEY (provider, key_id, metric)\n);\n\n-- Usage history for time-window queries\nCREATE TABLE usage_history (\n    id SERIAL PRIMARY KEY,\n    provider VARCHAR(50) NOT NULL,\n    key_id VARCHAR(100) NOT NULL,\n    metric VARCHAR(50) NOT NULL,\n    delta DOUBLE PRECISION NOT NULL,\n    timestamp TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Cache table with TTL\nCREATE TABLE cache (\n    key VARCHAR(255) PRIMARY KEY,\n    value TEXT NOT NULL,\n    expiry TIMESTAMP WITH TIME ZONE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Indexes for performance\nCREATE INDEX idx_usage_history_provider_key_metric_time \nON usage_history(provider, key_id, metric, timestamp);\n\nCREATE INDEX idx_usage_history_time ON usage_history(timestamp);\nCREATE INDEX idx_cache_expiry ON cache(expiry) WHERE expiry IS NOT NULL;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Connection Pooling"}),": Efficient database connection management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Prepared Statements"}),": SQL injection prevention and performance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transaction Management"}),": Atomic operations across multiple tables"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Migration Support"}),": Automatic schema creation and updates"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Query Optimization"}),": Efficient SQL queries with proper indexing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Handling"}),": Database-specific error mapping"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);