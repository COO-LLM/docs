"use strict";(globalThis.webpackChunkcoo_llm_docs=globalThis.webpackChunkcoo_llm_docs||[]).push([[1181],{8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var i=s(6540);const l={},r=i.createContext(l);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},9215:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>g,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Reference/Logging","title":"Logging","description":"COO-LLM provides structured logging with file output and Prometheus metrics integration.","source":"@site/content/Reference/Logging.md","sourceDirName":"Reference","slug":"/Reference/Logging","permalink":"/docs/docs/Reference/Logging","draft":false,"unlisted":false,"editUrl":"https://github.com/coo-llm/coo-llm-main/tree/main/docs/content/content/Reference/Logging.md","tags":[{"inline":true,"label":"developer-guide","permalink":"/docs/docs/tags/developer-guide"},{"inline":true,"label":"logging","permalink":"/docs/docs/tags/logging"}],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"tags":["developer-guide","logging"]},"sidebar":"tutorialSidebar","previous":{"title":"Storage","permalink":"/docs/docs/Reference/Storage"},"next":{"title":"Contributing","permalink":"/docs/docs/Contributing/Guidelines"}}');var l=s(4848),r=s(8453);const o={sidebar_position:5,tags:["developer-guide","logging"]},t="Logging",d={},c=[{value:"Log Implementation",id:"log-implementation",level:2},{value:"Log Levels",id:"log-levels",level:2},{value:"Structured Logging",id:"structured-logging",level:2},{value:"Configuration",id:"configuration",level:2},{value:"File Logging",id:"file-logging",level:3},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Log Types",id:"log-types",level:2},{value:"Request Logs",id:"request-logs",level:3},{value:"Application Logs",id:"application-logs",level:3},{value:"Storage Operation Logs",id:"storage-operation-logs",level:3},{value:"Prometheus Metrics",id:"prometheus-metrics-1",level:3},{value:"Output Backends",id:"output-backends",level:2},{value:"File Backend",id:"file-backend",level:3},{value:"Prometheus Backend",id:"prometheus-backend",level:3},{value:"Log Analysis",id:"log-analysis",level:2},{value:"Log Queries",id:"log-queries",level:3},{value:"Monitoring",id:"monitoring",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Log Levels",id:"log-levels-1",level:3},{value:"Structured Fields",id:"structured-fields",level:3},{value:"Retention",id:"retention",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Log Inspection",id:"log-inspection",level:3},{value:"Implementation Notes",id:"implementation-notes",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"logging",children:"Logging"})}),"\n",(0,l.jsx)(n.p,{children:"COO-LLM provides structured logging with file output and Prometheus metrics integration."}),"\n",(0,l.jsx)(n.h2,{id:"log-implementation",children:"Log Implementation"}),"\n",(0,l.jsxs)(n.p,{children:["Based on ",(0,l.jsx)(n.code,{children:"internal/log/logger.go"}),", COO-LLM uses Zerolog for structured JSON logging with the following features:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"File logging with rotation"}),"\n",(0,l.jsx)(n.li,{children:"Prometheus metrics integration"}),"\n",(0,l.jsx)(n.li,{children:"Request logging with context"}),"\n",(0,l.jsx)(n.li,{children:"Structured JSON format"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"log-levels",children:"Log Levels"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"INFO:"})," Normal operations and request logs"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WARN:"})," Warnings and non-critical issues"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ERROR:"})," Errors and failures"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"DEBUG:"})," Detailed debugging (when enabled)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"structured-logging",children:"Structured Logging"}),"\n",(0,l.jsx)(n.p,{children:"Logs use JSON format with consistent fields:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "provider": "openai-prod",\n  "model": "gpt-4o",\n  "reqID": "1234567890",\n  "latencyMS": 1200,\n  "status": 200,\n  "tokens": 150,\n  "error": "",\n  "time": "2024-01-01T12:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(n.h3,{id:"file-logging",children:"File Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'logging:\n  file:\n    enabled: true\n    path: "./logs/llm.log"\n    max_size_mb: 100\n    max_backups: 5\n'})}),"\n",(0,l.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'logging:\n  prometheus:\n    enabled: true\n    endpoint: "/metrics"\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Note:"})," HTTP webhooks and advanced batching are not yet implemented."]}),"\n",(0,l.jsx)(n.h2,{id:"log-types",children:"Log Types"}),"\n",(0,l.jsx)(n.h3,{id:"request-logs",children:"Request Logs"}),"\n",(0,l.jsxs)(n.p,{children:["Logged for each chat completion request via ",(0,l.jsx)(n.code,{children:"logger.LogRequest()"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "provider": "openai-prod",\n  "model": "gpt-4o",\n  "reqID": "1699123456789",\n  "latencyMS": 1200,\n  "status": 200,\n  "tokens": 150,\n  "error": "",\n  "time": "2024-01-01T12:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Fields:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"provider"}),": Provider ID used for the request"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"model"}),": Model name requested"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"reqID"}),": Unique request identifier"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"latencyMS"}),": Response time in milliseconds"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"status"}),": HTTP status code"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"tokens"}),": Total tokens used"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"error"}),": Error message (if any)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"application-logs",children:"Application Logs"}),"\n",(0,l.jsx)(n.p,{children:"General application events and errors:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "level": "info",\n  "message": "Starting server on :2906",\n  "time": "2024-01-01T12:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"storage-operation-logs",children:"Storage Operation Logs"}),"\n",(0,l.jsx)(n.p,{children:"All storage backends log database operations for monitoring and debugging:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "level": "debug",\n  "operation": "GetUsage",\n  "provider": "openai",\n  "keyID": "key1",\n  "metric": "req",\n  "value": 45,\n  "message": "store operation",\n  "time": "2024-01-01T12:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "level": "debug",\n  "operation": "IncrementUsage",\n  "provider": "openai",\n  "keyID": "key1",\n  "metric": "tokens",\n  "delta": 150,\n  "old_value": 1200,\n  "new_value": 1350,\n  "message": "store operation",\n  "time": "2024-01-01T12:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Storage Log Fields:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"operation"}),": Operation type (GetUsage, SetUsage, IncrementUsage, etc.)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"provider"}),": Provider identifier"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"keyID"}),": API key identifier"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"metric"}),": Metric name (req, tokens, etc.)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"value"}),"/",(0,l.jsx)(n.code,{children:"delta"}),": Numeric values involved"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"error"}),": Error message for failed operations"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"prometheus-metrics-1",children:"Prometheus Metrics"}),"\n",(0,l.jsxs)(n.p,{children:["When enabled, metrics are exposed at ",(0,l.jsx)(n.code,{children:"/metrics"})," endpoint."]}),"\n",(0,l.jsx)(n.h2,{id:"output-backends",children:"Output Backends"}),"\n",(0,l.jsx)(n.h3,{id:"file-backend",children:"File Backend"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Features:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JSON structured logging"}),"\n",(0,l.jsx)(n.li,{children:"Automatic rotation by size"}),"\n",(0,l.jsx)(n.li,{children:"Configurable retention"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'logging:\n  file:\n    enabled: true\n    path: "./logs/llm.log"\n    max_size_mb: 100\n    max_backups: 5\n'})}),"\n",(0,l.jsx)(n.h3,{id:"prometheus-backend",children:"Prometheus Backend"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Features:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Metrics endpoint at ",(0,l.jsx)(n.code,{children:"/metrics"})]}),"\n",(0,l.jsx)(n.li,{children:"Integration with monitoring systems"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'logging:\n  prometheus:\n    enabled: true\n    endpoint: "/metrics"\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Note:"})," HTTP webhooks, batching, filtering, and advanced features are not yet implemented."]}),"\n",(0,l.jsx)(n.h2,{id:"log-analysis",children:"Log Analysis"}),"\n",(0,l.jsx)(n.h3,{id:"log-queries",children:"Log Queries"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Find slow requests:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"grep '\"latencyMS\":[0-9]\\{4,\\}' logs/llm.log\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Count requests by provider:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"grep '\"provider\"' logs/llm.log | jq -r '.provider' | sort | uniq -c\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Find errors:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'grep \'"level":"error"\' logs/llm.log\n'})}),"\n",(0,l.jsx)(n.h3,{id:"monitoring",children:"Monitoring"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Prometheus metrics can be scraped for monitoring:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-prometheus",children:"# Metrics are available at /metrics when enabled\n"})}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"log-levels-1",children:"Log Levels"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"INFO:"})," Normal request logging"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"WARN:"})," Warnings"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ERROR:"})," Errors and failures"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"structured-fields",children:"Structured Fields"}),"\n",(0,l.jsx)(n.p,{children:"Request logs include:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"provider"}),": Provider used"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"model"}),": Model requested"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"reqID"}),": Request correlation ID"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"latencyMS"}),": Response time"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"status"}),": HTTP status"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"tokens"}),": Token usage"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"error"}),": Error details"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"retention",children:"Retention"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Application logs:"})," Configurable via ",(0,l.jsx)(n.code,{children:"max_backups"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Log rotation:"})," Automatic by size (",(0,l.jsx)(n.code,{children:"max_size_mb"}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Logs not appearing:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Check file permissions on ",(0,l.jsx)(n.code,{children:"./logs/"})," directory"]}),"\n",(0,l.jsxs)(n.li,{children:["Verify ",(0,l.jsx)(n.code,{children:"logging.file.enabled: true"})]}),"\n",(0,l.jsx)(n.li,{children:"Check available disk space"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Log rotation not working:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Ensure write permissions on log directory"}),"\n",(0,l.jsxs)(n.li,{children:["Check ",(0,l.jsx)(n.code,{children:"max_size_mb"})," and ",(0,l.jsx)(n.code,{children:"max_backups"})," settings"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"log-inspection",children:"Log Inspection"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# View recent logs\ntail -f logs/llm.log | jq .\n\n# Search for specific request ID\ngrep \"1234567890\" logs/llm.log\n\n# Count requests by status\njq -r '.status' logs/llm.log | sort | uniq -c\n"})}),"\n",(0,l.jsx)(n.h2,{id:"implementation-notes",children:"Implementation Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Logging is synchronous to ensure request logs are written"}),"\n",(0,l.jsx)(n.li,{children:"Uses Zerolog for high-performance structured logging"}),"\n",(0,l.jsx)(n.li,{children:"File rotation prevents disk space issues"}),"\n",(0,l.jsx)(n.li,{children:"Prometheus integration provides metrics endpoint"}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);